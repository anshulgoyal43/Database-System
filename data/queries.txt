LOAD EMPLOYEE
Q1_temp <- SELECT Salary >= 30000 FROM EMPLOYEE
Q1 <- PROJECT Ssn, Salary FROM Q1_temp
CLEAR Q1_temp

Q2_EE <- CROSS EMPLOYEE EMPLOYEE
Q2_EE1 <- SELECT EMPLOYEE1_Super_ssn == EMPLOYEE2_Ssn FROM Q2_EE
Q2_EE2 <- SELECT EMPLOYEE1_Bdate == EMPLOYEE2_Bdate FROM Q2_EE1
Q2 <- PROJECT EMPLOYEE1_Ssn, EMPLOYEE1_Super_ssn, EMPLOYEE1_Bdate FROM Q2_EE2
CLEAR Q2_EE2
RENAME EMPLOYEE1_Ssn TO Ssn FROM Q2
RENAME EMPLOYEE1_Super_ssn TO Super_ssn FROM Q2
RENAME EMPLOYEE1_Bdate TO Bdate FROM Q2

LOAD WORKS_ON
Q3_EE1 <- SELECT EMPLOYEE1_Sex == 0 FROM Q2_EE
Q3_EE2 <- SELECT EMPLOYEE2_Sex == 1 FROM Q3_EE1
Q3_EE3 <- PROJECT EMPLOYEE1_Ssn, EMPLOYEE2_Ssn FROM Q3_EE2
CLEAR Q2_EE
CLEAR Q3_EE1
CLEAR Q3_EE2
LOAD PROJECT
Q3_WW <- CROSS WORKS_ON WORKS_ON
Q3_WW1 <- SELECT WORKS_ON1_Pno == WORKS_ON2_Pno FROM Q3_WW
Q3_EW1 <- CROSS Q3_WW1 Q3_EE3
Q3_EW2 <- SELECT EMPLOYEE1_Ssn == WORKS_ON1_Essn FROM Q3_EW1
Q3_EW3 <- SELECT EMPLOYEE2_Ssn == WORKS_ON2_Essn FROM Q3_EW2
Q3 <- PROJECT WORKS_ON1_Pno FROM Q3_EW3
CLEAR Q3_EE3
CLEAR Q3_WW
CLEAR Q3_EW1
CLEAR Q3_EW2
CLEAR Q3_EW3
RENAME WORKS_ON1_Pno TO Pno FROM Q3

Q4_EW1 <- CROSS Q3_WW1 Q2_EE1
Q4_EW2 <- SELECT EMPLOYEE1_Ssn == WORKS_ON1_Essn FROM Q4_EW1
Q4_EW3 <- SELECT EMPLOYEE2_Ssn == WORKS_ON2_Essn FROM Q4_EW2
Q4 <- PROJECT EMPLOYEE1_Ssn, EMPLOYEE2_Ssn, WORKS_ON1_Pno FROM Q4_EW3
RENAME EMPLOYEE1_Ssn TO Ssn FROM Q4
RENAME EMPLOYEE2_Ssn TO Super_ssn FROM Q4
RENAME WORKS_ON1_Pno TO Pno FROM Q4
CLEAR Q2_EE1
CLEAR Q3_WW1
CLEAR Q4_EW1
CLEAR Q4_EW2
CLEAR Q4_EW3

Q5 <- SELECT Dnum != 4 FROM PROJECT

EXPORT Q1
EXPORT Q2
EXPORT Q3
EXPORT Q4
EXPORT Q5
QUIT